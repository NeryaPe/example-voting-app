pipeline {

  
  environment {
        GOOGLE_APPLICATION_CREDENTIALS = credentials('gcp')
  }


    stage('kubectl config') {
      steps {
        container('terraform-gcloud'){
            sh("gcloud auth activate-service-account  --key-file=${env.GOOGLE_APPLICATION_CREDENTIALS}")
            sh 'gcloud container clusters get-credentials  my-project-1490158303721-gke --project my-project-1490158303721 --region us-central1'
            sh 'kubectl get nodes'
            sh 'helm version'
        }
      }
    }
  }
}